@model PowerTracker.Models.Diet

<h1>Edit Diet Record</h1>

<form action="/Diets/Edit" method="post">
    <!-- Hidden field for ID -->
    <input type="hidden" name="Id" value="@Model.Id" />

    <!-- Dropdown for Food Selection -->
    <div class="form-group">
        <label for="FoodName">Select Food</label>
        <select id="FoodName" name="FoodName" class="form-control">
            <option value="">-- Select Food --</option>
            <option value="Apple" data-calories="52">Apple</option>
            <option value="Banana" data-calories="96">Banana</option>
            <option value="Chicken Breast" data-calories="165">Chicken Breast</option>
            <option value="Rice" data-calories="130">Rice</option>
            <option value="Broccoli" data-calories="35">Broccoli</option>
        </select>
    </div>

    <!-- Input for Quantity -->
    <div class="form-group">
        <label for="QuantityInGrams">Quantity (in grams)</label>
        <input type="number" id="QuantityInGrams" name="QuantityInGrams" class="form-control" value="@Model.QuantityInGrams" />
    </div>

    <!-- Display Calculated Calories -->
    <div class="form-group">
        <label for="Calories">Total Calories</label>
        <input type="number" id="Calories" name="Calories" class="form-control" value="@Model.Calories" readonly />
    </div>

    <!-- Submit Button -->
    <button type="submit" class="btn btn-primary">Save Changes</button>
    <a href="/Diets/Index" class="btn btn-secondary">Cancel</a>
</form>

<script>
    // Preselect the current food in the dropdown
    document.getElementById("FoodName").value = "@Model.FoodName";

    // Function to calculate calories
    function calculateCalories() {
        const foodSelect = document.getElementById("FoodName");
        const selectedOption = foodSelect.options[foodSelect.selectedIndex];
        const caloriesPer100g = parseFloat(selectedOption.getAttribute("data-calories")) || 0;
        const quantity = parseFloat(document.getElementById("QuantityInGrams").value) || 0;

        const totalCalories = (caloriesPer100g * quantity) / 100;
        document.getElementById("Calories").value = totalCalories.toFixed(2);
    }

    // Add event listeners to update calories dynamically
    document.getElementById("FoodName").addEventListener("change", calculateCalories);
    document.getElementById("QuantityInGrams").addEventListener("input", calculateCalories);

    // Calculate calories on page load
    calculateCalories();
</script>
